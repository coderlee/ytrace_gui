webpackJsonp([1],{"1Bj8":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table"},[s("tbody",t._l(t.showFiles,function(e,i){return s("tr",{class:{"table-active":i===t.select},on:{click:function(s){t.rowClicked(e)}}},[s("td",[t._v(t._s(e.sapi))]),t._v(" "),s("td",[t._v(t._s(e.method))]),t._v(" "),s("td",{staticClass:"uri"},[t._v(t._s(e.uri))]),t._v(" "),s("td",[t._v(t._s(e.file))]),t._v(" "),s("td",[t._v(t._s(e.size))]),t._v(" "),s("td",[t._v(t._s(e.time))])])}))])},n=[],r={render:i,staticRenderFns:n};e.a=r},"21zj":function(t,e){},"240R":function(t,e,s){"use strict";var i=s("7+uW");e.a=new i.a({data:function(){return{curSourceFile:""}}})},"3XeG":function(t,e){},"68IZ":function(t,e,s){"use strict";var i=s("kX7f"),n=s.n(i),r=s("EzsT"),a=(s.n(r),s("eKfU")),o=(s.n(a),s("V71o")),c=s.n(o),l=s("0XFg").sprintf;e.a={name:"Trace-Source",components:{vueLoading:c.a},data:function(){return{loading:!0,initOk:!1,id:"",sourceEditor:null,varEditor:null,file:"",line:0,type:"",level:0,items:[],fileCoverage:{},step:-1,stepHistory:[],codeHeight:0}},watch:{"$route.params.id":function(t){void 0!==t&&""!==this.id&&this.id!==t&&(this.id=t,this.fetchTrace(),this.reset())}},mounted:function(){var t=this,e=document.body,s=document.documentElement,i=Math.max(e.scrollHeight,e.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight);this.codeHeight=i-document.getElementById("head").clientHeight-44,this.sourceEditor=this.initEditor(this.$refs.code,!0),this.varEditor=this.initEditor(this.$refs.var,!1),this.fetchTrace(),this.$bus.$on("gotoLine",function(e){t.sourceEditor.gotoLine(e)})},activated:function(){this.$route.query.step&&this.stepInto(this.step,Number(this.$route.query.step))},methods:{initEditor:function(t,e){var s=this,i=n.a.edit(t);return i.getSession().setMode("ace/mode/php"),i.setTheme("ace/theme/monokai"),i.setReadOnly(!0),i.$blockScrolling=1/0,i.renderer.$cursorLayer.element.style.opacity=0,i.renderer.setShowGutter(e),i.on("gutterclick",function(t){var e=s.fileCoverage[s.file],i=t.editor.getCursorPosition().row+1,n=-1;for(var r in e)Number(r)===i&&(n=e[r]);n>=0&&s.stepInto(s.step,n)},!1),i},fetchTrace:function(){var t=this;this.loading=!0,this.id=this.$route.params.id,this.$http.get("/traces/"+encodeURI(this.id)).then(function(e){var s=e.data.trimRight().split("\n"),i=[],n={};delete s[0];for(var r in s){var a=s[r].split("\t");a[3]=Number(a[3]),"F"===a[2]&&(a[5]=Number(a[5])),i.push(a),n[a[0]]||(n[a[0]]={}),n[a[0]][a[1]]||(n[a[0]][a[1]]=Number(r)-1)}t.items=i,t.fileCoverage=n,t.loading=!1,t.stepInto(-1,0)})},stripslashes:function(t){return(t+"").replace(/\\./g,function(t){return new Function('return "'+t+'"')()||t})},stepInto:function(t,e){var s=this.items[e];if(s)switch(t>=0&&this.stepHistory.push(t),this.step=e,this.line=s[1],this.type=s[2],this.level=s[3],s[0]!==this.file?(this.file=s[0],this.loadFile()):this.sourceEditor.gotoLine(this.line),this.type){case"A":this.varEditor.setValue("<?php\n/*\n * Assignment\n */\n"+this.stripslashes(s[4])+" = "+this.stripslashes(s[5]));break;case"F":for(var i=[],n=[],r=s[5],a=6;a<6+2*r;a+=2)n.push(this.stripslashes(s[a])),i.push(this.stripslashes(s[a])+" = "+this.stripslashes(s[a+1]));this.varEditor.setValue(l("<?php\n/*\n * Function Call\n */\n%s(\n%s\n)",s[4],i.join("\n\n")));break;case"I":this.varEditor.setValue("<?php\n/*\n * include\n */\n"+this.stripslashes(s[5]));break;case"E":this.varEditor.setValue("<?php\n/*\n * {eval}\n */\n"+this.stripslashes(s[5]));break;default:this.varEditor.setValue("")}},stepOver:function(){if("F"!==this.type&&"I"!==this.type)return void this.stepInto(this.step,this.step+1);for(var t=this.step+1,e=this.items[t];e&&!(e[3]<this.level)&&("F"!==e[2]&&"I"!==e[2]||e[3]!==this.level);)t++,e=this.items[t];e&&this.stepInto(this.step,t)},stepOut:function(){var t=this.step+1,e=this.items[t],s=this.level;for("F"!==this.type&&"I"!==this.type&&"E"!==this.type||(s-=1);e&&!(e[3]<s)&&("F"!==e[2]&&"I"!==e[2]&&"E"!==e[2]||e[3]!==s);)t++,e=this.items[t];e&&this.stepInto(this.step,t)},stepBack:function(){this.stepHistory.length>0&&this.stepInto(-1,this.stepHistory.pop())},reset:function(){this.file="",this.line=0,this.type="",this.level=0,this.step=-1,this.stepHistory=[],this.stepInto(-1,0)},loadFile:function(){var t=this;this.$bus.curSourceFile=this.file,this.$http.get("/source?file="+encodeURI(this.file)).then(function(e){var s=t.sourceEditor;s.setValue(e.data),s.gotoLine(t.line),s.renderer.on("afterRender",function(){console.log("afterRender");for(var e=t.$refs.code.querySelector("div.ace_gutter-layer").childNodes,i=t.fileCoverage[t.file],n=t.sourceEditor.getCursorPosition().row,r=0;r<e.length;r++){var a=e[r];void 0!==i[a.innerText]?(n===Number(a.innerText)-1?a.style.backgroundColor="#1e7e34":a.style.backgroundColor="#87ff9d",a.style.cursor="pointer"):(a.style.backgroundColor=null,a.style.cursor=null)}s.focus()})})}}}},"9M+g":function(t,e){},DUku:function(t,e){},Drzj:function(t,e,s){"use strict";var i=s("hiCB"),n=s.n(i),r=s("V71o"),a=s.n(r),o=s("0XFg").sprintf;e.a={name:"Trace-Stack",components:{vueLoading:a.a},data:function(){return{loading:!0,id:this.$route.params.id,items:[],stackHeight:0,scrollTop:0,lowestLevel:n.a}},created:function(){this.fetchTrace()},mounted:function(){var t=this;console.log("--------\x3estack mounted");var e=document.body,s=document.documentElement,i=Math.max(e.scrollHeight,e.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight);this.stackHeight=i-document.body.offsetHeight,this.$refs.stack.addEventListener("scroll",function(){t.scrollTop=t.$refs.stack.scrollTop})},activated:function(){void 0!==this.$route.params.id&&(this.id!==this.$route.params.id?(this.id=this.$route.params.id,this.scrollTop=0,this.fetchTrace()):this.scrollTop>0&&(this.$refs.stack.scrollTop=this.scrollTop))},methods:{stripslashes:function(t){return(t+"").replace(/\\./g,function(t){return new Function('return "'+t+'"')()||t})},fetchTrace:function(){var t=this;this.loading=!0,this.$http.get("/traces/"+this.id).then(function(e){var s=e.data.trimRight().split("\n");delete s[0];var i=[];for(var n in s){var r=s[n].split("\t"),a="";switch(r[2]){case"A":a=t.stripslashes(r[4])+" = "+t.stripslashes(r[5]);break;case"F":for(var c=[],l=r[5],h=6;h<6+2*l;h+=2)c.push(t.stripslashes(r[h])+" = "+t.stripslashes(r[h+1]));a=o("%s (%s)",r[4],c.join(", "));break;case"I":a="include("+t.stripslashes(r[5])+")";break;case"E":a="{eval}("+t.stripslashes(r[5])+")"}var u=Number(r[3]);u<t.lowestLevel&&(t.lowestLevel=u),i.push({statement:a,step:n-1,file:r[0],line:r[1],type:r[2],level:u})}t.items=i,t.loading=!1,console.log("lowestLevel",t.lowestLevel)})},jump:function(t){this.$router.push({name:"Source",params:{id:this.id},query:{step:t}})}}}},Fs8J:function(t,e,s){"use strict";e.a={name:"Home",data:function(){return{files:[],fields:[{key:"sapi",sortable:!0},{key:"method",sortable:!0},{key:"uri",sortable:!0,tdClass:"uri"},{key:"file",sortable:!0},{key:"size",sortable:!1},{key:"time",sortable:!0}]}},mounted:function(){this.fetchTraces()},methods:{rowClicked:function(t,e,s){this.$router.push({name:"Source",params:{id:t.file}})},fetchTraces:function(){var t=this;this.$http.get("/traces").then(function(e){t.files=e.data,console.log(t.files)})},clearTraces:function(){var t=this;this.$http.delete("/traces").then(function(e){t.fetchTraces()})}}}},HCoV:function(t,e){},Jltp:function(t,e,s){"use strict";var i=s("Wq+S"),n=s("fWJJ");e.a={components:{TracesNav:i.a,FileNav:n.a},data:function(){return{search:"",type:"",select:0,enter:!1,showLen:0}},mounted:function(){var t=this;document.onkeydown=function(e){if(console.log(e),"Escape"===e.key)return t.type="",void(t.enter=!1);switch(!0){case"o"===e.key&&e.ctrlKey:e.preventDefault(),t.search="",t.select=0,t.type="traces-nav",t.enter=!1,t.$refs.popupList.show();break;case"r"===e.key&&e.ctrlKey&&"Source"===t.$route.name:e.preventDefault(),t.search="",t.select=0,t.type="file-nav",t.enter=!1,t.$refs.popupList.show();break;case t.$refs.popupList.is_show&&"ArrowDown"===e.key&&t.showLen>1:t.select===t.showLen-1?t.select=0:t.select+=1;break;case t.$refs.popupList.is_show&&"ArrowUp"===e.key&&t.showLen>1:0===t.select?t.select=t.showLen-1:t.select-=1;break;case t.$refs.popupList.is_show&&"Enter"===e.key&&t.showLen>0:t.enter=!0}}},methods:{searchInputFocus:function(){this.$refs.searchInput.focus()},updateShowLen:function(t){this.showLen=t},close:function(){this.type="",this.enter=!1,this.$refs.popupList.hide()}}}},Jmt5:function(t,e){},K5QJ:function(t,e,s){"use strict";e.a={props:{search:String,select:Number,enter:Boolean},data:function(){return{files:[],showFiles:[]}},mounted:function(){this.fetchTraceFiles()},watch:{search:function(t){console.log(t);var e=[];for(var s in this.files)this.files[s].uri&&this.files[s].uri.indexOf(t)>=0?e.push(this.files[s]):this.files[s].file.indexOf(t)>=0&&e.push(this.files[s]);this.showFiles=e,this.$emit("updateShowLen",this.showFiles.length)},enter:function(t){t&&(this.$emit("close"),this.$router.push({name:"Source",params:{id:this.showFiles[this.select].file}}))}},methods:{fetchTraceFiles:function(){var t=this;this.$http.get("/traces").then(function(e){t.search="",t.files=e.data.slice(0,10),t.showFiles=t.files,t.$emit("updateShowLen",t.showFiles.length)})},rowClicked:function(t){this.$emit("close"),this.$router.push({name:"Source",params:{id:t.file}})}}}},LoQm:function(t,e,s){"use strict";function i(t){s("3XeG")}var n=s("Drzj"),r=s("qXUV"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-4351fd4f",null);e.a=c.exports},M93x:function(t,e,s){"use strict";function i(t){s("21zj")}var n=s("xJD8"),r=s("hpS7"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-025d5711",null);e.a=c.exports},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),n=s("M93x"),r=s("YaEn"),a=s("mtWM"),o=s.n(a),c=s("sCSS"),l=s("240R"),h=s("Jmt5"),u=(s.n(h),s("9M+g"));s.n(u);i.a.use(c.a),i.a.prototype.$http=o.a,i.a.prototype.$bus=l.a,i.a.config.productionTip=!1,new i.a({el:"#app",router:r.a,template:"<App/>",components:{App:n.a}})},OUSy:function(t,e){},RQcw:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-list-group",{staticStyle:{"max-height":"35rem","overflow-y":"scroll"}},t._l(t.showItems,function(e,i){return s("b-list-group-item",{key:i,class:{active:i===t.select},on:{click:function(s){t.rowClicked(e.line)}}},[t._v("\n    "+t._s(e.prototype)+"\n  ")])}))},n=[],r={render:i,staticRenderFns:n};e.a=r},"Wq+S":function(t,e,s){"use strict";function i(t){s("seGP")}var n=s("K5QJ"),r=s("1Bj8"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-24870b3c",null);e.a=c.exports},YaEn:function(t,e,s){"use strict";var i=s("7+uW"),n=s("/ocq"),r=s("eWLx"),a=s("LoQm"),o=s("lO7g");i.a.use(n.a),e.a=new n.a({routes:[{path:"/trace/source/:id",name:"Source",component:r.a},{path:"/trace/call/:id",name:"Stack",component:a.a},{path:"/home",name:"Home",component:o.a}]})},aGEy:function(t,e){},bpnn:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{ref:"popupList",attrs:{"hide-header":"","hide-footer":"",size:"lg"},on:{shown:t.searchInputFocus}},[s("div",{staticStyle:{padding:"0 10rem","margin-bottom":"1rem"}},[s("b-form-input",{ref:"searchInput",attrs:{type:"text"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),"traces-nav"===t.type?s("traces-nav",{attrs:{enter:t.enter,search:t.search,select:t.select},on:{close:t.close,updateShowLen:t.updateShowLen}}):t._e(),t._v(" "),"file-nav"===t.type?s("file-nav",{attrs:{enter:t.enter,search:t.search,select:t.select},on:{close:t.close,updateShowLen:t.updateShowLen}}):t._e()],1)},n=[],r={render:i,staticRenderFns:n};e.a=r},cUy1:function(t,e,s){"use strict";e.a={props:{search:String,select:Number,enter:Boolean},data:function(){return{showItems:[],items:[]}},mounted:function(){console.log("FileNav--\x3emounted"),this.fetchFileNav()},watch:{search:function(t){console.log(t);var e=[];for(var s in this.items)this.items[s].name.indexOf(t)>=0&&e.push(this.items[s]);this.showItems=e,this.$emit("updateShowLen",this.showItems.length)},enter:function(t){t&&(this.$emit("close"),this.$bus.$emit("gotoLine",this.showItems[this.select].line))}},methods:{fetchFileNav:function(){var t=this;this.$http.get("/file-nav?file="+encodeURI(this.$bus.curSourceFile)).then(function(e){t.search="";var s=[];for(var i in e.data){var n=e.data[i];n.class?s.push({name:n.name,prototype:n.class+"::"+n.name+"("+n.params+")",line:n.line}):s.push({name:n.name,prototype:n.name+"("+n.params+")",line:n.line})}t.items=s,t.showItems=t.items,t.$emit("updateShowLen",t.showItems.length)})},rowClicked:function(t){this.$emit("close"),this.$bus.$emit("gotoLine",t)}}}},dcIi:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-container",{staticStyle:{"text-align":"center"}},[s("b-row",[s("b-col",{staticStyle:{"text-align":"left"}},[s("div",{staticStyle:{margin:"1rem 0"}},[s("b-button",{attrs:{variant:"danger"},on:{click:function(e){t.clearTraces()}}},[t._v("Clear Traces")]),t._v(" "),s("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){t.fetchTraces()}}},[t._v("Refresh")])],1),t._v(" "),s("b-table",{attrs:{hover:"",items:t.files,fields:t.fields},on:{"row-clicked":t.rowClicked}})],1)],1)],1)},n=[],r={render:i,staticRenderFns:n};e.a=r},eWLx:function(t,e,s){"use strict";function i(t){s("aGEy")}var n=s("68IZ"),r=s("rApO"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-6dec0ee4",null);e.a=c.exports},fWJJ:function(t,e,s){"use strict";function i(t){s("DUku")}var n=s("cUy1"),r=s("RQcw"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-2f888d8e",null);e.a=c.exports},h02k:function(t,e,s){"use strict";var i=s("Jltp"),n=s("bpnn"),r=s("VU/8"),a=r(i.a,n.a,null,null,null);e.a=a.exports},hpS7:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{attrs:{id:"head"}},[s("b-navbar",{attrs:{toggleable:"md",type:"light",variant:"light"}},[s("b-nav-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),s("b-navbar-brand",{attrs:{href:"#"}},[t._v("Ytrace")]),t._v(" "),s("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[s("b-nav",{attrs:{"is-nav-bar":""}},[s("b-nav-item",[s("router-link",{staticClass:"nav-link",class:{active:"Home"==t.nav},attrs:{to:"/home"}},[t._v("Home")])],1),t._v(" "),s("b-nav-item",[s("router-link",{staticClass:"nav-link",class:{disabled:""==t.traceId,active:"Source"==t.nav},attrs:{event:t.traceId?"click":"",to:"/trace/source/"+t.traceId}},[t._v("Source")])],1),t._v(" "),s("b-nav-item",[s("router-link",{staticClass:"nav-link",class:{disabled:""==t.traceId,active:"Stack"==t.nav},attrs:{event:t.traceId?"click":"",to:"/trace/call/"+t.traceId}},[t._v("Stack")])],1)],1)],1)],1)],1),t._v(" "),s("keep-alive",{attrs:{exclude:"Home"}},[s("router-view")],1),t._v(" "),s("popup-list")],1)},n=[],r={render:i,staticRenderFns:n};e.a=r},lO7g:function(t,e,s){"use strict";function i(t){s("OUSy"),s("HCoV")}var n=s("Fs8J"),r=s("dcIi"),a=s("VU/8"),o=i,c=a(n.a,r.a,o,"data-v-7eb551e8",null);e.a=c.exports},qXUV:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"stack",staticStyle:{overflow:"scroll"},style:{height:t.stackHeight+"px"}},t._l(t.items,function(e){return s("div",{staticClass:"statement",style:{padding:"0.5rem 0rem 0rem "+3*(e.level-t.lowestLevel)+"rem"},on:{click:function(s){t.jump(e.step)}}},[s("div",{staticStyle:{float:"left",color:"#7c7c7d"}},[t._v(t._s(e.file)+":"+t._s(e.line))]),t._v(" "),s("pre",{class:{scope:"F"===e.type||"I"===e.type||"E"===e.type}},[t._v(t._s(e.statement))])])})),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticStyle:{"margin-top":"5%"}},[s("vue-loading",{attrs:{type:"bars",color:"#d9544e",size:{width:"8rem",height:"6rem"}}})],1)])},n=[],r={render:i,staticRenderFns:n};e.a=r},rApO:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[s("div",{staticStyle:{padding:"0.5rem 1rem"}},[s("h6",{directives:[{name:"show",rawName:"v-show",value:t.file,expression:"file"}],staticStyle:{display:"inline-block",color:"rgba(0, 0, 0, 0.5)"}},[t._v(t._s(t.file)+":"+t._s(t.line))]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.reset()}}},[t._v("reset")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.stepOut()}}},[t._v("step out")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.stepOver()}}},[t._v("step over")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.stepBack()}}},[t._v("step back")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.stepInto(t.step,t.step+1)}}},[t._v("step into")])],1),t._v(" "),s("div",{staticClass:"container-fluid"},[s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{ref:"code",staticStyle:{width:"100%","font-size":"1rem"},style:{height:t.codeHeight+"px"}})]),t._v(" "),s("b-col",[s("div",{ref:"var",staticStyle:{width:"100%","font-size":"1rem"},style:{height:t.codeHeight+"px"}})])],1)],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticStyle:{"margin-top":"5%"}},[s("vue-loading",{attrs:{type:"bars",color:"#d9544e",size:{width:"8rem",height:"6rem"}}})],1)])},n=[],r={render:i,staticRenderFns:n};e.a=r},seGP:function(t,e){},xJD8:function(t,e,s){"use strict";var i=s("h02k");e.a={name:"app",components:{PopupList:i.a},data:function(){return{nav:"Home",traceId:""}},watch:{$route:"activateNav"},mounted:function(){console.log(this.$route),this.activateNav()},methods:{activateNav:function(){this.nav=this.$route.name,this.$route.params.id&&(this.traceId=this.$route.params.id)}}}}},["NHnr"]);